/*
Ascensor.js
Modified version (2013-09-15) : options added by Nicolas Huguet
Original version :
version: 1.6.2 (2013-06-05)
description: Ascensor is a jquery plugin which aims to train and adapt content according to an elevator system
repository: https://github.com/kirkas/Ascensor.js
license: BSD
author: Léo Galley <contact@kirkas.ch>
*/
(function(e,t,n){function s(t,n){this.element=t;this.options=e.extend(true,{},i,n);this._defaults=i;this._name=r;this.init()}var r="ascensor",i={ascensorName:"ascensor",ascensorFloorName:null,childType:"div",windowsOn:0,direction:"y",directionOnSize:null,loop:true,ascensorMap:"",time:"1000",easing:"linear",keyNavigation:true,queued:false,queuedDirection:"x",overflow:"scroll",position:{left:0,right:0,bottom:0,top:0},positionOnSize:{type:"width",size:0,position:{left:0,right:0,bottom:0,top:0}},minWidth:null,minHeight:null};s.prototype.init=function(){function c(t){e(r).css("top",t.top);e(r).css("bottom",t.bottom);e(r).css("left",t.left);e(r).css("right",t.right)}function h(r){if(t.location.hash){l=t.location.hash.split("/").pop();e(n.options.ascensorFloorName).each(function(t,i){if(l===n.options.ascensorFloorName[t]){s=t;e("."+n.options.ascensorName+"Link").removeClass(n.options.ascensorName+"LinkActive").eq(s).addClass(n.options.ascensorName+"LinkActive");if(!r){d(s,n.options.time,true)}}})}}function p(){var o=e(t).width();var l=e(t).height();if(n.options.directionOnSize!=null){var h=false;if(n.options.directionOnSize.type=="width"){if(o<=n.options.directionOnSize.size){h=true}}if(n.options.directionOnSize.type=="height"){if(l<=n.options.directionOnSize.size){h=true}}if(h){n.options.direction=n.options.directionOnSize.direction}else{n.options.direction=f}}var p=n.options.position;if(n.options.positionOnSize.type=="width"&&o<=n.options.positionOnSize.size||n.options.positionOnSize.type=="height"&&l<=n.options.positionOnSize.size){p=n.options.positionOnSize.position}c(p);var d=o;if(n.options.minWidth!=null){if(o<n.options.minWidth){d=n.options.minWidth}}var v=e(t).height();if(n.options.minHeight!=null){if(e(t).height()<n.options.minHeight){v=n.options.minHeight}}u=d-p.left-p.right;a=v-p.top-p.bottom;e(i).width(u).height(a);e(r).width(u).height(a);if(n.options.direction==="y"){e(r).stop().scrollTop(s*a)}if(n.options.direction==="x"){e(r).stop().scrollLeft(s*u);e(i).each(function(t){e(this).css("left",t*u);e(this).css("top",0)})}if(n.options.direction==="chocolate"){e(i).each(function(t){e(this).css({left:n.options.ascensorMap[t][1]*u,top:n.options.ascensorMap[t][0]*a})});e(r).stop().scrollLeft(n.options.ascensorMap[s][1]*u).scrollTop(n.options.ascensorMap[s][0]*a)}}function d(i,o,f){if(f){m()}if(n.options.direction==="y"){e(r).stop().animate({scrollTop:i*a},o,n.options.easing,function(){g()})}if(n.options.direction==="x"){e(r).stop().animate({scrollLeft:i*u},o,n.options.easing,function(){g()})}if(n.options.direction==="chocolate"){if(n.options.queued){if(n.options.queuedDirection==="x"){if(e(r).scrollLeft()===n.options.ascensorMap[i][1]*u){e(r).stop().animate({scrollTop:n.options.ascensorMap[i][0]*a},o,n.options.easing,function(){g()})}else{e(r).stop().animate({scrollLeft:n.options.ascensorMap[i][1]*u},o,n.options.easing,function(){e(r).stop().animate({scrollTop:n.options.ascensorMap[i][0]*a},o,n.options.easing,function(){g()})})}}else if(n.options.queuedDirection==="y"){if(e(r).scrollTop()===n.options.ascensorMap[i][0]*a){e(r).stop().animate({scrollLeft:n.options.ascensorMap[i][1]*u},o,n.options.easing,function(){g()})}else{e(r).stop().animate({scrollTop:n.options.ascensorMap[i][0]*a},o,n.options.easing,function(){e(r).stop().animate({scrollLeft:n.options.ascensorMap[i][1]*u},o,n.options.easing,function(){g()})})}}}else{e(r).stop().animate({scrollLeft:n.options.ascensorMap[i][1]*u,scrollTop:n.options.ascensorMap[i][0]*a},o,n.options.easing,function(){g()})}}if(!f){if(n.options.ascensorFloorName!==null){t.location.hash="/"+n.options.ascensorFloorName[i]}}e("."+n.options.ascensorName+"Link").removeClass(n.options.ascensorName+"LinkActive");e("."+n.options.ascensorName+"Link"+i).addClass(n.options.ascensorName+"LinkActive");s=i}function v(t){if(e("input, textarea, button").is(":focus")){return false}switch(t.which){case 40:case 83:e(r).trigger({type:"ascensorDown",floor:s});break;case 38:case 87:e(r).trigger({type:"ascensorUp",floor:s});break;case 37:case 65:e(r).trigger({type:"ascensorLeft",floor:s});break;case 39:case 68:e(r).trigger({type:"ascensorRight",floor:s});break}}function m(){e(r).trigger({type:"ascensorStart",floor:s})}function g(){e(r).trigger({type:"ascensorEnd",floor:s})}function y(){if(n.options.direction=="y"){e(r).trigger({type:"ascensorNext",floor:s})}else if(n.options.direction=="chocolate"){T(1,0)}}function b(){if(n.options.direction=="y"){e(r).trigger({type:"ascensorPrev",floor:s})}else if(n.options.direction=="chocolate"){T(-1,0)}}function w(){if(n.options.direction=="x"){e(r).trigger({type:"ascensorPrev",floor:s})}else if(n.options.direction=="chocolate"){T(0,-1)}}function E(){if(n.options.direction=="x"){e(r).trigger({type:"ascensorNext",floor:s})}else if(n.options.direction=="chocolate"){T(0,1)}}function S(){var e=s-1;if(e<0){if(n.options.loop){e=o}else{e=0}}d(e,n.options.time)}function x(){var e=s+1;if(e>o){if(n.options.loop){e=0}else{e=o}}d(e,n.options.time)}function T(t,r){var i=[n.options.ascensorMap[s][0]+t,n.options.ascensorMap[s][1]+r];e.each(n.options.ascensorMap,function(e){if(i.toString()==n.options.ascensorMap[e].toString()){d(e,n.options.time)}})}var n=this,r=this.element,i=e(r).children(n.options.childType),s=n.options.windowsOn,o=-1,u,a,f=n.options.direction,l;e(r).css("position","absolute").width(u).height(a);e(r).css("overflow",n.options.overflow);c(n.options.position);e(i).width(u).height(a).each(function(){o+=1;e(this).attr("id",n.options.ascensorName+"Floor"+o).addClass(n.options.ascensorName+"Floor")});if(n.options.direction==="x"||n.options.direction==="chocolate"){e(i).css({position:"absolute",overflow:"auto"})}e(t).resize(function(){p()}).load(function(){p()}).resize();if(t.DeviceOrientationEvent){e(t).bind("orientationchange",function(){p()})}if(n.options.keyNavigation){e(document).keydown(v)}e(r).on("ascensorLeft",function(){w()});e(r).on("ascensorRight",function(){E()});e(r).on("ascensorUp",function(){b()});e(r).on("ascensorDown",function(){y()});e(r).on("ascensorNext",function(){x()});e(r).on("ascensorPrev",function(){S()});e("."+n.options.ascensorName+"LinkPrev").on("click",function(){S()});e("."+n.options.ascensorName+"LinkNext").on("click",function(){x()});e("."+n.options.ascensorName+"LinkLeft").on("click",function(){w()});e("."+n.options.ascensorName+"LinkRight").on("click",function(){E()});e("."+n.options.ascensorName+"LinkUp").on("click",function(){y()});e("."+n.options.ascensorName+"LinkDown").on("click",function(){b()});e("."+n.options.ascensorName+"Link").on("click",function(){var t=parseInt(e(this).attr("class").split(" ")[1].split(n.options.ascensorName+"Link")[1],10);d(t,n.options.time)});d(s,1,true);e(t).on("hashchange",function(){h()});h(true)};e.fn[r]=function(t){return this.each(function(){if(!e.data(this,"plugin_"+r)){e.data(this,"plugin_"+r,new s(this,t))}})}})(jQuery,window)